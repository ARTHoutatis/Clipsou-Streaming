<!DOCTYPE html>
<html lang="fr" translate="no">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
  <meta name="google" content="notranslate">
  <meta name="googlebot" content="notranslate">
  <meta http-equiv="Content-Language" content="fr">
  <!-- Maintenance mode check -->
  <script src="maintenance.js"></script>
  <title>Proposer un film â€“ Clipsou Streaming</title>
  <link rel="icon" href="images/favicon.webp" type="image/webp">
  <!-- Performance detector -->
  <script src="performance-detector.js"></script>
  <link rel="stylesheet" href="request.css?v=1">
  <script src="i18n.js" defer></script>
  <!-- Google Identity Services -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body class="notranslate">
  <main class="container" id="app">
    <div class="header">
      <div>
        <h1 data-i18n="request.title">ğŸ“½ï¸ Proposer un film</h1>
        <div id="userInfo" class="user-info" hidden></div>
      </div>
      <div class="header-actions">
        <button type="button" id="logoutBtn" class="btn secondary" data-i18n="request.logout" hidden>ğŸšª Se dÃ©connecter</button>
        <a href="/" class="btn secondary back-btn" data-i18n="request.back">â† Retour Ã  l'accueil</a>
      </div>
    </div>

    <!-- Pending request notification -->
    <div id="pendingRequestNotice" class="notice notice-info" hidden>
      <strong id="pendingNoticeTitle" data-i18n="request.pending.title">ğŸ“‹ Demande en cours</strong>
      <p id="pendingNoticeMessage" data-i18n="request.pending.message">Vous avez une demande en attente de validation par les administrateurs.</p>
      <div class="pending-details" id="pendingDetails"></div>
      <div class="pending-actions">
        <button type="button" id="cancelRequestBtn" class="btn danger" data-i18n="request.pending.cancel">Annuler ma demande</button>
        <button type="button" id="newRequestBtn" class="btn primary" data-i18n="request.pending.new" hidden>Nouvelle demande</button>
      </div>
    </div>

    <!-- Stepper Navigation -->
    <div class="stepper-container" id="stepperContainer">
      <div class="stepper">
        <div class="step active" data-step="1">
          <div class="step-circle">1</div>
          <div class="step-label" data-i18n="request.step.terms">Conditions</div>
        </div>
        <div class="step-line"></div>
        <div class="step" data-step="2">
          <div class="step-circle">2</div>
          <div class="step-label" data-i18n="request.step.auth">Connexion</div>
        </div>
        <div class="step-line"></div>
        <div class="step" data-step="3">
          <div class="step-circle">3</div>
          <div class="step-label" data-i18n="request.step.guide">Guide</div>
        </div>
        <div class="step-line"></div>
        <div class="step" data-step="4">
          <div class="step-circle">4</div>
          <div class="step-label" data-i18n="request.step.form">Formulaire</div>
        </div>
      </div>
    </div>

    <!-- Slides Container -->
    <div class="slides-container">
      <!-- Slide 1: Terms and Conditions -->
      <section class="form-section terms-section slide active" data-slide="1">
        <h2 data-i18n="request.terms.title">ğŸ“œ Conditions d'utilisation</h2>
      <div class="terms-content">
        <p class="terms-intro" data-i18n="request.terms.intro">Avant de soumettre votre demande, veuillez lire attentivement et respecter les conditions suivantes :</p>
        <ul class="terms-list">
          <li>
            <strong data-i18n="request.terms.complete">âœ… Remplissez tous les champs</strong>
            <p data-i18n="request.terms.complete.desc">Assurez-vous de complÃ©ter tous les champs requis du formulaire avec des informations exactes et complÃ¨tes.</p>
          </li>
          <li>
            <strong data-i18n="request.terms.notroll">ğŸš« Pas de trolling</strong>
            <p data-i18n="request.terms.notroll.desc">Les demandes fantaisistes, offensantes ou non sÃ©rieuses seront automatiquement rejetÃ©es et pourront entraÃ®ner un blocage.</p>
          </li>
          <li>
            <strong data-i18n="request.terms.filmsonly">ğŸ¥ Films uniquement</strong>
            <p data-i18n="request.terms.filmsonly.desc">Cette plateforme est dÃ©diÃ©e aux FILMS. Ne soumettez pas de vidÃ©os courtes, sketches, vlogs ou autres contenus non-cinÃ©matographiques.</p>
          </li>
          <li>
            <strong data-i18n="request.terms.ratelimit">â±ï¸ Une demande par jour</strong>
            <p data-i18n="request.terms.ratelimit.desc">Vous Ãªtes limitÃ© Ã  une seule demande par pÃ©riode de 24 heures. Vous pouvez annuler votre demande actuelle pour en soumettre une nouvelle.</p>
          </li>
        </ul>
        <div class="terms-accept">
          <label class="checkbox-label">
            <input type="checkbox" id="termsAccepted" required>
            <span data-i18n="request.terms.accept">J'ai lu et j'accepte les conditions d'utilisation ci-dessus</span>
          </label>
          <div id="termsError" class="error-message" hidden>
            <span data-i18n="request.terms.error">âš ï¸ Vous devez accepter les conditions d'utilisation pour soumettre votre demande.</span>
          </div>
        </div>
        <div class="slide-nav">
          <button type="button" class="btn primary" id="nextStep1" data-i18n="request.terms.button">J'accepte â†’</button>
        </div>
      </div>
      </section>

      <!-- Slide 2: Google OAuth Login -->
      <section class="form-section auth-section slide" data-slide="2">
        <h2 data-i18n="request.auth.title">ğŸ” Connexion requise</h2>
        <p class="auth-description" data-i18n="request.auth.desc">Pour soumettre un film, vous devez vous connecter avec votre compte Google et vÃ©rifier que vous Ãªtes propriÃ©taire de votre chaÃ®ne YouTube.</p>
        
        <div class="auth-reasons">
          <h3 data-i18n="request.auth.why">Pourquoi cette connexion ?</h3>
          <ul>
            <li data-i18n="request.auth.verify">âœ… VÃ©rifier que vous Ãªtes propriÃ©taire de la chaÃ®ne YouTube</li>
            <li data-i18n="request.auth.prevent">âœ… Ã‰viter les soumissions frauduleuses</li>
            <li data-i18n="request.auth.protect">âœ… ProtÃ©ger les crÃ©ateurs de contenu</li>
            <li data-i18n="request.auth.associate">âœ… Associer vos demandes Ã  votre compte</li>
          </ul>
        </div>

        <!-- Google Sign-In button - Generated dynamically by google-auth.js -->
        <!-- Le bouton se traduit automatiquement selon la langue dÃ©finie dans localStorage -->
        <!-- Pas besoin de boutons FR/EN sur cette page - utiliser ceux du footer de l'index -->
        <div id="googleSignInButton" class="google-signin-container"></div>
        
        <div id="authError" class="error-message" hidden></div>
        
        <div class="auth-footer">
          <p class="small muted" data-i18n="request.auth.footer">En vous connectant, vous acceptez que nous accÃ©dions aux informations de votre chaÃ®ne YouTube pour vÃ©rifier votre propriÃ©tÃ©.</p>
          <p class="small muted" style="margin-top: 8px;">
            <a href="privacy.html" target="_blank" rel="noopener noreferrer" style="color: #3b82f6; text-decoration: none;">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 4px;">
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
              </svg>
              <span data-i18n="request.auth.privacy">Consulter notre politique de confidentialitÃ©</span>
            </a>
          </p>
        </div>
        
        <div class="slide-nav" id="authNextNav" hidden>
          <button type="button" class="btn secondary" id="prevStep2" data-i18n="request.auth.prev">â† Retour</button>
          <button type="button" class="btn primary" id="nextStep2" data-i18n="request.auth.next">Suivant â†’</button>
        </div>
      </section>

      <!-- Slide 3: Tutorial Section -->
      <section class="form-section tutorial-section slide" data-slide="3">
        <h2 data-i18n="request.tutorial.title">ğŸ“š Guide visuel des images</h2>
      <p class="tutorial-intro" data-i18n="request.tutorial.intro">Voici un exemple de carte de film pour vous aider Ã  comprendre le positionnement des diffÃ©rentes images :</p>
      <div class="tutorial-card-wrapper">
        <div class="tutorial-card">
          <div class="tutorial-card-media">
            <div class="tutorial-overlay" data-i18n="request.tutorial.portrait">Affiche Portrait</div>
            <div class="tutorial-label portrait" data-i18n="request.tutorial.portrait.format">Format 9:12 (vertical)</div>
            <div class="tutorial-badge-overlay">
              <div class="tutorial-badge" data-i18n="request.tutorial.badge">Badge Studio</div>
            </div>
          </div>
          <div class="tutorial-card-content">
            <div class="tutorial-rating" data-i18n="request.tutorial.rating">Note du contenu</div>
          </div>
        </div>
        <div class="tutorial-fiche">
          <div class="tutorial-fiche-image">
            <div class="tutorial-overlay" data-i18n="request.tutorial.landscape">Image Fiche</div>
            <div class="tutorial-label landscape" data-i18n="request.tutorial.landscape.format">Format 16:9 (paysage)</div>
          </div>
          <p class="tutorial-note" data-i18n="request.tutorial.landscape.note">Cette image s'affiche sur la page dÃ©taillÃ©e du contenu</p>
        </div>
      </div>
      <div class="tutorial-tips">
        <h3 data-i18n="request.tutorial.tips">ğŸ’¡ Conseils pour vos images</h3>
        <ul>
          <li data-i18n="request.tutorial.tip.portrait"><strong>Affiche Portrait (9:12)</strong> - UtilisÃ©e sur les cartes de la page d'accueil. Taille recommandÃ©e : 540x720px minimum</li>
          <li data-i18n="request.tutorial.tip.landscape"><strong>Image Fiche (16:9)</strong> - AffichÃ©e sur la page de dÃ©tail du contenu. Taille recommandÃ©e : 1920x1080px</li>
          <li data-i18n="request.tutorial.tip.badge"><strong>Badge Studio</strong> - Logo de votre chaÃ®ne/studio pour diffÃ©rencier les crÃ©ateurs. Fond transparent recommandÃ© (.png). Taille : 200x80px</li>
          <li data-i18n="request.tutorial.tip.formats">Formats acceptÃ©s : JPG, PNG, WebP. Poids max : 10MB par image</li>
        </ul>
      </div>
      <div class="slide-nav">
        <button type="button" class="btn secondary" id="prevStep3" data-i18n="request.tutorial.prev">â† PrÃ©cÃ©dent</button>
        <button type="button" class="btn primary" id="nextStep3" data-i18n="request.tutorial.next">Suivant â†’</button>
      </div>
      </section>

      <!-- Slide 4: Request Form -->
      <section class="form-section slide" id="requestFormSection" data-slide="4">
        <h2 data-i18n="request.form.title">ğŸ¬ Informations du contenu</h2>
      <form id="requestForm" autocomplete="off">
        <div class="grid">
          <label>
            <span><span data-i18n="request.form.title.field">Titre</span> <span class="required">*</span></span>
            <input type="text" id="title" required disabled>
          </label>
          <label>
            <span><span data-i18n="request.form.type">Type</span> <span class="required">*</span></span>
            <select id="type" required disabled>
              <option value="film" selected data-i18n="request.form.type.film">Film</option>
              <option value="sÃ©rie" data-i18n="request.form.type.series">SÃ©rie</option>
              <option value="trailer" data-i18n="request.form.type.trailer">Trailer</option>
            </select>
          </label>
        </div>

        <div class="grid">
          <label>
            <span><span data-i18n="request.form.genre">Genre</span> 1 <span class="required">*</span></span>
            <input type="text" id="genre1" list="genresDatalist" required disabled placeholder="ex: Action" autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false">
          </label>
          <label>
            <span><span data-i18n="request.form.genre">Genre</span> 2 <span class="required">*</span></span>
            <input type="text" id="genre2" list="genresDatalist" required disabled placeholder="ex: Aventure" autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false">
          </label>
          <label>
            <span><span data-i18n="request.form.genre">Genre</span> 3 <span class="required">*</span></span>
            <input type="text" id="genre3" list="genresDatalist" required disabled placeholder="ex: ComÃ©die" autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false">
          </label>
        </div>

        <label>
          <span><span data-i18n="request.form.description">Description</span> <span class="required">*</span> <small id="descriptionCounter" style="color: #888; font-weight: 400;">(0/400)</small></span>
          <textarea id="description" rows="5" maxlength="400" required disabled data-i18n-placeholder="request.form.description.placeholder" placeholder="DÃ©crivez le contenu..."></textarea>
        </label>

        <div class="grid">
          <label>
            <span><span data-i18n="request.form.portrait">Affiche (format 9/12)</span> <span class="required">*</span></span>
            <input type="hidden" id="portraitImage">
            <div class="actions">
              <label class="btn file-label" data-i18n="request.form.upload">
                Importer image
                <input type="file" id="portraitFileInput" accept="image/*" hidden disabled>
              </label>
              <button type="button" id="portraitClearBtn" class="btn secondary" data-i18n="request.form.clear" disabled>Effacer</button>
            </div>
            <img id="portraitPreview" class="img-preview" alt="AperÃ§u portrait" hidden>
          </label>
          <label>
            <span><span data-i18n="request.form.landscape">Image fiche (paysage 16/9)</span> <span class="required">*</span></span>
            <input type="hidden" id="landscapeImage">
            <div class="actions">
              <label class="btn file-label" data-i18n="request.form.upload">
                Importer image
                <input type="file" id="landscapeFileInput" accept="image/*" hidden disabled>
              </label>
              <button type="button" id="landscapeClearBtn" class="btn secondary" data-i18n="request.form.clear" disabled>Effacer</button>
            </div>
            <img id="landscapePreview" class="img-preview" alt="AperÃ§u paysage" hidden>
          </label>
          <label>
            <span data-i18n="request.form.badge">Badge studio (image)</span>
            <input type="hidden" id="studioBadge">
            <div class="actions">
              <label class="btn file-label" data-i18n="request.form.upload">
                Importer image
                <input type="file" id="studioBadgeFileInput" accept="image/*" hidden disabled>
              </label>
              <button type="button" id="studioBadgeClearBtn" class="btn secondary" data-i18n="request.form.clear" disabled>Effacer</button>
            </div>
            <small class="muted" style="display:block;margin-top:4px;" data-i18n="request.form.badge.info">ğŸ’¡ Votre dernier badge studio est automatiquement rÃ©utilisÃ©</small>
            <img id="studioBadgePreview" class="img-preview" alt="AperÃ§u badge studio" hidden>
          </label>
        </div>

        <fieldset disabled>
          <legend data-i18n="request.form.actors">Acteurs & Doubleurs</legend>
          <div id="actorsList" class="actors-list"></div>
          <div class="actor-row">
            <input type="text" id="actorName" data-i18n-placeholder="request.form.actor.name" placeholder="Nom de l'acteur">
            <input type="text" id="actorRole" data-i18n-placeholder="request.form.actor.role" placeholder="RÃ´le">
            <button type="button" id="addActorBtn" class="btn secondary" data-i18n="request.form.actor.add">Ajouter</button>
          </div>
        </fieldset>

        <fieldset disabled id="watchUrlFieldset">
          <legend data-i18n="request.form.watchurl">Lien de visionnage</legend>
          <label>
            <span><span data-i18n="request.form.youtube">Lien YouTube</span> <span class="required">*</span></span>
            <input type="url" id="watchUrl" placeholder="https://www.youtube.com/...">
            <div id="videoVerificationStatus" class="verification-status" hidden></div>
          </label>
        </fieldset>

        <fieldset disabled id="episodesFieldset" style="display:none;">
          <legend data-i18n="request.form.episodes">Ã‰pisodes</legend>
          <div id="episodesList" class="actors-list"></div>
          <div class="actor-row">
            <input type="text" id="episodeTitle" data-i18n-placeholder="request.form.episode.title" placeholder="Titre de l'Ã©pisode" style="flex:2;">
            <input type="url" id="episodeUrl" data-i18n-placeholder="request.form.episode.url" placeholder="Lien YouTube de l'Ã©pisode" style="flex:2;">
            <button type="button" id="addEpisodeBtn" class="btn secondary" data-i18n="request.form.episode.add">Ajouter</button>
          </div>
        </fieldset>
      </form>
      <datalist id="genresDatalist">
        <option value="Action">
        <option value="Aventure">
        <option value="Animation">
        <option value="Brickfilm">
        <option value="ComÃ©die">
        <option value="Documentaire">
        <option value="Drame">
        <option value="Familial">
        <option value="Fantastique">
        <option value="Guerre">
        <option value="Historique">
        <option value="Horreur">
        <option value="Musical">
        <option value="MystÃ¨re">
        <option value="Policier">
        <option value="Romance">
        <option value="Science-Fiction">
        <option value="Super-hÃ©ros">
        <option value="Thriller">
        <option value="Western">
      </datalist>
      <div class="slide-nav">
        <button type="button" class="btn secondary" id="prevStep4" data-i18n="request.form.prev">â† PrÃ©cÃ©dent</button>
        <button type="button" id="submitBtn" class="btn primary" data-i18n="request.form.submit">ğŸ“¤ Envoyer la demande</button>
        <button type="button" id="resetBtn" class="btn secondary" data-i18n="request.form.reset">ğŸ”„ RÃ©initialiser</button>
      </div>
      </section>
    </div>
    <!-- End Slides Container -->

    <!-- Rate limit notification -->
    <div id="rateLimitNotice" class="notice notice-warning" hidden>
      <strong data-i18n="request.limit.title">â³ Limite atteinte</strong>
      <p data-i18n="request.limit.message">Vous avez dÃ©jÃ  soumis une demande aujourd'hui. Vous pourrez soumettre une nouvelle demande demain.</p>
      <p class="small" id="nextRequestTime"></p>
    </div>

    <!-- Request History -->
    <section class="form-section" id="historySection" hidden>
      <h2 data-i18n="request.history.title">ğŸ“œ Historique de mes demandes</h2>
      <div id="historyList" class="history-list"></div>
    </section>

    <!-- Success Message -->
    <div id="successMessage" class="notice notice-success" hidden>
      <strong data-i18n="request.success.title">âœ… Demande soumise avec succÃ¨s !</strong>
      <p data-i18n="request.success.message">Votre demande a Ã©tÃ© envoyÃ©e aux administrateurs. Vous recevrez une rÃ©ponse prochainement.</p>
      <p class="small" data-i18n="request.success.cooldown">Vous pourrez soumettre une nouvelle demande dans 24 heures.</p>
    </div>
    </div><!-- End mainContent -->
  </main>

  <script src="i18n.js"></script>
  <script src="config.js"></script>
  <script src="google-auth.js?v=20251108-i18n-support"></script>
  <script>
    // Load banned users data for verification (shared with admin via localStorage)
    window.ClipsouAdmin = window.ClipsouAdmin || {};
    window.ClipsouAdmin.isUserBanned = function(email, channelId) {
      try {
        const data = localStorage.getItem('clipsou_banned_users_v1');
        const banned = data ? JSON.parse(data) : [];
        return banned.some(user => {
          if (email && user.email === email) return true;
          if (channelId && user.channelId === channelId) return true;
          return false;
        });
      } catch {
        return false;
      }
    };
  </script>
  <script src="request.js?v=20251108-i18n-support"></script>
</body>
</html>
